# CCTEST - POPS tests script

GLOBAL RUN_DELAY            0.053
GLOBAL STOP_DELAY           0.1
GLOBAL ITER_PERIOD_US       1000
GLOBAL FG_LIMITS            DISABLED
GLOBAL SIM_LOAD             ENABLED
GLOBAL GROUP                tests
GLOBAL PROJECT              POPS

# Voltage source parameters

VS BANDWIDTH                180
VS Z                        0.9
VS V_REF_DELAY_ITERS        4.989

# Measurement parameters

MEAS B_REG_SELECT           UNFILTERED
MEAS I_REG_SELECT           UNFILTERED
MEAS B_DELAY_ITERS          0.001
MEAS I_DELAY_ITERS          1.3
MEAS V_DELAY_ITERS          1.3
MEAS B_FIR_LENGTHS          0
MEAS I_FIR_LENGTHS          0
MEAS B_SIM_NOISE_PP         0.0
MEAS I_SIM_NOISE_PP         0.03
MEAS V_SIM_NOISE_PP         0.05
MEAS TONE_HALF_PERIOD_ITERS 100
MEAS I_SIM_TONE_AMP         0.0

# Limits

LIMITS B_POS                20000.0
LIMITS B_MIN                0.0
LIMITS B_NEG                0.0
LIMITS B_RATE               40000.0
LIMITS B_ACCELERATION       1.0E7
LIMITS B_CLOSELOOP          400
LIMITS B_ERR_WARNING        10.0
LIMITS B_ERR_FAULT          100.0
                            
LIMITS I_POS                6000.0
LIMITS I_MIN                0.0
LIMITS I_NEG                0.0
LIMITS I_RATE               20000.0
LIMITS I_ACCELERATION       5.0E6
LIMITS I_CLOSELOOP          150
LIMITS I_ERR_WARNING        5.0
LIMITS I_ERR_FAULT          50.0
LIMITS I_QUADRANTS41        0.0,6000.0
                            
LIMITS V_POS                9000.0
LIMITS V_NEG                -7000.0
LIMITS V_RATE               0.0
LIMITS V_ACCELERATION       0.0
LIMITS V_ERR_WARNING        50.0
LIMITS V_ERR_FAULT          100.0
LIMITS V_QUADRANTS41        9000.0,7000.0

# Default parameters for pre-functions

DEFAULT V_ACCELERATION      1.000000E+06
DEFAULT V_DECELERATION      1.000000E+06
DEFAULT V_LINEAR_RATE       0.000000E+00
DEFAULT I_ACCELERATION      1.000000E+05
DEFAULT I_DECELERATION      1.000000E+05
DEFAULT I_LINEAR_RATE       0.000000E+00
DEFAULT B_ACCELERATION      2.500000E+05
DEFAULT B_DECELERATION      2.500000E+05
DEFAULT B_LINEAR_RATE       0.000000E+00
DEFAULT PLATEAU_DURATION    3.000000E-02

# Load

LOAD OHMS_SER               0.02
LOAD OHMS_PAR               1.0E8
LOAD OHMS_MAG               0.3
LOAD HENRYS                 0.96
LOAD HENRYS_SAT             0.36
LOAD I_SAT_START            3600.0
LOAD I_SAT_END              6000.0
LOAD GAUSS_PER_AMP          2.5
LOAD SIM_TC_ERROR           -0.05

# Current regulation

IREG AUXPOLE1_HZ            0 0 0 0
IREG PERIOD_ITERS           3
IREG TRACK_DELAY_PERIODS    2.97905333
IREG R                      1.22326E+02,-1.05946E+02,-3.32311E-01,-6.21207E-01,9.91852E-03,-1.27053E-04,0.00000E+00,0.00000E+00,0.00000E+00,0.00000E+00
IREG S                      1.00000E+00,-1.17458E+00,5.93306E-01,-4.00334E-01,-1.82619E-02,-1.30100E-04,0.00000E+00,0.00000E+00,0.00000E+00,0.00000E+00
IREG T                      3.05981E+02,-6.55287E+02,5.40418E+02,-2.20515E+02,5.16617E+01,-7.46682E+00,6.80644E-01,-3.82706E-02,1.21585E-03,-1.67392E-05

# Field Regulation

BREG PERIOD_ITERS           3
BREG AUXPOLE1_HZ            20 20 20 20
BREG AUXPOLES2_HZ           20 20 20 20
BREG AUXPOLE4_HZ            20 20 20 20
BREG AUXPOLE5_HZ            20 20 20 20

#BREG TRACK_DELAY_PERIODS    3.0246033
#BREG R                      1.03332E+02,-2.37229E+02,1.92560E+02,-5.35859E+01,-9.22479E-01,-6.35276E-01,0.00000E+00,0.00000E+00,0.00000E+00,0.00000E+00
#BREG S                      1.00000E+00,-2.07341E+00,1.47500E+00,-5.69565E-01,3.66917E-01,-1.83218E-01,-1.57215E-02,0.00000E+00,0.00000E+00,0.00000E+00
#BREG T                      7.76803E+01,-2.10100E+02,2.39744E+02,-1.43393E+02,4.66900E+01,-7.50669E+00,4.05211E-01,0.00000E+00,0.00000E+00,0.00000E+00

# V_REF

PPPL INITIAL_REF(1)         10.0
PPPL ACCELERATION1(1)        1.0E5,    1.0E5,     1.0E5
PPPL ACCELERATION2(1)       -1.0E4,   -0.0E4,    -1.0E4
PPPL ACCELERATION3(1)       -1.0E5,   -1.0E5,    -1.0E5
PPPL RATE2(1)                 20E3,     20E3,      20E3
PPPL RATE4(1)                  1E1,     -1E1,       0.0
PPPL REF4(1)                 500.0,   1000.0,    5000.0
PPPL DURATION4(1)              1.0,      1.0,       1.0

# I_REF

RAMP INITIAL_REF(2)         0
RAMP FINAL_REF(2)           400.0
RAMP ACCELERATION(2)        1.0E7
RAMP DECELERATION(2)        1.0E6
RAMP LINEAR_RATE(2)         0.0

PPPL INITIAL_REF(3)         400.0
PPPL ACCELERATION1(3)        1.0E5,    5.0E4,     5.0E4
PPPL ACCELERATION2(3)       -5.0E3,     -0.0,    -5.0E3
PPPL ACCELERATION3(3)       -5.0E4,   -5.0E4,    -5.0E4
PPPL RATE2(3)                 6.0E3,   6.0E3,     6.0E3
PPPL RATE4(3)                  1E2,     -1E2,       0.0
PPPL REF4(3)                3000.0,   5000.0,    6000.0
PPPL DURATION4(3)              0.2,      0.2,       0.2

TABLE TIME(4)                 0.0,   0.4,   0.5,   1.5,   1.7
TABLE REF(4)                400.0,2000.0,2000.0,5000.0,5000.0

# B_REF

RAMP INITIAL_REF(5)         0
RAMP FINAL_REF(5)           1000.0
RAMP ACCELERATION(5)        2.5E7
RAMP DECELERATION(5)        1.0E6
RAMP LINEAR_RATE(5)         0.0

PPPL INITIAL_REF(6)         1000.0
PPPL ACCELERATION1(6)        1.0E5,    1.0E5,     1.0E5
PPPL ACCELERATION2(6)       -1.0E4,   -0.0E4,    -1.0E4
PPPL ACCELERATION3(6)       -1.0E5,   -1.0E5,    -1.0E5
PPPL RATE2(6)                 20E3,     10E3,      20E3
PPPL RATE4(6)                  2E2,      0.0,       0.0
PPPL REF4(6)                5000.0,  10000.0,   12500.0
PPPL DURATION4(6)              0.2,      0.2,       0.2

TABLE TIME(7)                  0.0,   0.4,   0.5,    1.5,    1.7
TABLE REF(7)                1000.0,4000.0,4000.0,12000.0,12000.0

# Voltage

GLOBAL CYCLE_SELECTOR       1
REF FUNCTION(1)             PPPL
REF REG_MODE(1)             VOLTAGE
GLOBAL FILE                 pops-openloop
RUN

# Refs

GLOBAL CYCLE_SELECTOR       2       3       4       5       6       7
#GLOBAL CYCLE_SELECTOR       5       6       7
REF FUNCTION(2)             RAMP    PPPL    TABLE   RAMP    PPPL    TABLE
REF REG_MODE(2)             CURRENT CURRENT CURRENT FIELD   FIELD   FIELD
GLOBAL FILE                 pops-closeloop
RUN

# EOF
